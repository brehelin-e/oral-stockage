<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>QCM</title>
</head>
<body>
  <h1>QCM - Évolution du Stockage</h1>
  <form id="quizForm">
    <p>1. SSD ou HDD ?</p>
    <input type="radio" name="q1" value="A" required /> A. SSD<br />
    <input type="radio" name="q1" value="B" /> B. HDD<br />

    <p>2. NVMe signifie ?</p>
    <input type="radio" name="q2" value="A" required /> A. Non-Volatile Memory Express<br />
    <input type="radio" name="q2" value="B" /> B. Nouveau Volume Magnétique Épuré<br />

    <button type="button" onclick="submitQuiz()">Envoyer</button>
  </form>

  <script>
    const user = localStorage.getItem("currentUser");
    const correctAnswers = { q1: "A", q2: "A" };
    const endpoint = "https://script.google.com/macros/s/AKfycbxAXdQ07ArLpFMQUsn_lUjPi5_Hqzwcljs6mAXCNoDeReiZZTs9aqZpmuSNfW_ynygUqg/exec";

    async function submitQuiz() {
      const form = document.getElementById("quizForm");
      const answers = {};
      let score = 0;
      let total = Object.keys(correctAnswers).length;

      for (let q in correctAnswers) {
        const val = form[q].value;
        answers[q] = val;
        if (val === correctAnswers[q]) score++;
      }

      try {
        const res = await fetch(endpoint, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username: user, score, total, ...answers })
        });
        window.location.href = "resultat.html";
      } catch (err) {
        alert("Erreur lors de l'envoi");
      }
    }
  </script>
</body>
</html>
